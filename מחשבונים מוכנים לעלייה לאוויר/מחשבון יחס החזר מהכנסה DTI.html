<!-- ××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (DTI) - ×”×× ×™××©×¨×• ×œ×™ ×”×œ×•×•××”? -->
<!-- PREFIX: wpc-calc-dti-k4m7- -->

<script>
if (!document.querySelector('meta[name="viewport"]')) {
  const viewport = document.createElement('meta');
  viewport.name = 'viewport';
  viewport.content = 'width=device-width, initial-scale=1.0, user-scalable=yes';
  document.head.appendChild(viewport);
}
</script>

<style>
:root {
  --wpc-dti-primary: #1e5490;
  --wpc-dti-primary-dark: #163d6b;
  --wpc-dti-primary-light: #e8f0f8;
  --wpc-dti-danger: #e74c3c;
  --wpc-dti-success: #25D366;
  --wpc-dti-warning: #f39c12;
  --wpc-dti-text-dark: #222;
  --wpc-dti-text-light: #555;
  --wpc-dti-bg-light: #f8f9fa;
  --wpc-dti-white: #fff;
  --wpc-dti-border: #ddd;
  --wpc-dti-shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
  --wpc-dti-shadow-md: 0 5px 20px rgba(0,0,0,0.12);
  --wpc-dti-radius-sm: 8px;
  --wpc-dti-radius-md: 12px;
  --wpc-dti-radius-lg: 20px;
  --wpc-dti-transition: all 0.3s ease;
}

.wpc-calc-dti-k4m7-wrapper {
  all: initial !important;
  display: block !important;
  font-family: 'Assistant', -apple-system, sans-serif !important;
  direction: rtl !important;
  text-align: right !important;
  max-width: 1200px !important;
  margin: 0 auto !important;
  padding: 20px !important;
  color: var(--wpc-dti-text-dark) !important;
  line-height: 1.6 !important;
  box-sizing: border-box !important;
  color-scheme: light !important;
}

.wpc-calc-dti-k4m7-wrapper *, .wpc-calc-dti-k4m7-wrapper *::before, .wpc-calc-dti-k4m7-wrapper *::after {
  box-sizing: border-box !important;
}

.wpc-calc-dti-k4m7-title-container { text-align: center !important; margin-bottom: 30px !important; }

.wpc-calc-dti-k4m7-title {
  font-size: 2.2rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  margin: 0 0 10px 0 !important;
}

.wpc-calc-dti-k4m7-subtitle {
  font-size: 1.1rem !important;
  color: var(--wpc-dti-text-light) !important;
  margin: 0 0 15px 0 !important;
}

.wpc-calc-dti-k4m7-update-date { font-size: 0.9rem !important; color: #777 !important; }

.wpc-calc-dti-k4m7-calculator {
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-lg) !important;
  box-shadow: var(--wpc-dti-shadow-md) !important;
  overflow: hidden !important;
  margin-bottom: 30px !important;
}

.wpc-calc-dti-k4m7-tabs-nav {
  display: flex !important;
  flex-wrap: wrap !important;
  background: var(--wpc-dti-bg-light) !important;
  border-bottom: 2px solid var(--wpc-dti-border) !important;
}

.wpc-calc-dti-k4m7-tab-btn {
  flex: 1 1 auto !important;
  min-width: 120px !important;
  padding: 15px 20px !important;
  background: transparent !important;
  border: none !important;
  cursor: pointer !important;
  font-family: inherit !important;
  font-size: 1rem !important;
  font-weight: 600 !important;
  color: var(--wpc-dti-text-light) !important;
  transition: var(--wpc-dti-transition) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 8px !important;
}

.wpc-calc-dti-k4m7-tab-btn:hover {
  background: rgba(30,84,144,0.1) !important;
  color: var(--wpc-dti-primary) !important;
}

.wpc-calc-dti-k4m7-tab-btn.active {
  background: var(--wpc-dti-white) !important;
  color: var(--wpc-dti-primary) !important;
  border-bottom: 3px solid var(--wpc-dti-primary) !important;
  margin-bottom: -2px !important;
}

.wpc-calc-dti-k4m7-tab-icon { font-size: 1.3rem !important; }

.wpc-calc-dti-k4m7-tab-content {
  display: none !important;
  padding: 30px !important;
  animation: wpcDtiFadeIn 0.3s ease !important;
}

.wpc-calc-dti-k4m7-tab-content.active { display: block !important; }

@keyframes wpcDtiFadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.wpc-calc-dti-k4m7-tab-title {
  font-size: 1.4rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  margin: 0 0 25px 0 !important;
  padding-bottom: 15px !important;
  border-bottom: 2px solid var(--wpc-dti-primary-light) !important;
}

.wpc-calc-dti-k4m7-form-grid {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  gap: 25px !important;
  margin-bottom: 25px !important;
}

.wpc-calc-dti-k4m7-form-group { display: flex !important; flex-direction: column !important; }
.wpc-calc-dti-k4m7-form-group.full-width { grid-column: 1 / -1 !important; }

.wpc-calc-dti-k4m7-label {
  font-size: 0.95rem !important;
  font-weight: 600 !important;
  color: var(--wpc-dti-text-dark) !important;
  margin-bottom: 8px !important;
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
}

.wpc-calc-dti-k4m7-slider-container { position: relative !important; }

.wpc-calc-dti-k4m7-slider-value {
  text-align: center !important;
  font-size: 1.5rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  margin-bottom: 10px !important;
}

.wpc-calc-dti-k4m7-slider {
  width: 100% !important;
  height: 8px !important;
  border-radius: 4px !important;
  background: linear-gradient(to left, var(--wpc-dti-primary) 0%, var(--wpc-dti-primary-light) 100%) !important;
  outline: none !important;
  -webkit-appearance: none !important;
  cursor: pointer !important;
}

.wpc-calc-dti-k4m7-slider::-webkit-slider-thumb {
  -webkit-appearance: none !important;
  width: 24px !important;
  height: 24px !important;
  border-radius: 50% !important;
  background: var(--wpc-dti-primary) !important;
  cursor: pointer !important;
  border: 3px solid var(--wpc-dti-white) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
}

.wpc-calc-dti-k4m7-slider::-moz-range-thumb {
  width: 24px !important;
  height: 24px !important;
  border-radius: 50% !important;
  background: var(--wpc-dti-primary) !important;
  cursor: pointer !important;
  border: 3px solid var(--wpc-dti-white) !important;
}

.wpc-calc-dti-k4m7-slider-range {
  display: flex !important;
  justify-content: space-between !important;
  font-size: 0.85rem !important;
  color: var(--wpc-dti-text-light) !important;
  margin-top: 5px !important;
}

.wpc-calc-dti-k4m7-results {
  background: linear-gradient(135deg, #f8fbff 0%, #eef5fc 100%) !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  padding: 25px !important;
  margin-top: 25px !important;
  border: 2px solid var(--wpc-dti-primary-light) !important;
}

.wpc-calc-dti-k4m7-results-title {
  font-size: 1.2rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  margin: 0 0 20px 0 !important;
  text-align: center !important;
}

.wpc-calc-dti-k4m7-results-main {
  display: grid !important;
  grid-template-columns: repeat(3, 1fr) !important;
  gap: 20px !important;
  margin-bottom: 25px !important;
}

.wpc-calc-dti-k4m7-result-card {
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  padding: 20px !important;
  text-align: center !important;
  box-shadow: var(--wpc-dti-shadow-sm) !important;
}

.wpc-calc-dti-k4m7-result-label {
  font-size: 0.9rem !important;
  margin-bottom: 8px !important;
  color: var(--wpc-dti-text-light) !important;
}

.wpc-calc-dti-k4m7-result-value {
  font-size: 1.8rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
}

/* Gauge / Safety Indicator */
.wpc-calc-dti-k4m7-gauge-container {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  padding: 30px !important;
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  margin-bottom: 25px !important;
}

.wpc-calc-dti-k4m7-gauge {
  position: relative !important;
  width: 200px !important;
  height: 120px !important;
  margin-bottom: 20px !important;
}

.wpc-calc-dti-k4m7-gauge-bg {
  position: absolute !important;
  width: 200px !important;
  height: 100px !important;
  border-radius: 100px 100px 0 0 !important;
  background: linear-gradient(90deg, var(--wpc-dti-success) 0%, var(--wpc-dti-success) 30%, var(--wpc-dti-warning) 30%, var(--wpc-dti-warning) 70%, var(--wpc-dti-danger) 70%, var(--wpc-dti-danger) 100%) !important;
  overflow: hidden !important;
}

.wpc-calc-dti-k4m7-gauge-cover {
  position: absolute !important;
  bottom: 0 !important;
  left: 10px !important;
  width: 180px !important;
  height: 90px !important;
  background: var(--wpc-dti-white) !important;
  border-radius: 90px 90px 0 0 !important;
}

.wpc-calc-dti-k4m7-gauge-needle {
  position: absolute !important;
  bottom: 0 !important;
  left: 50% !important;
  width: 4px !important;
  height: 80px !important;
  background: var(--wpc-dti-text-dark) !important;
  transform-origin: bottom center !important;
  transform: translateX(-50%) rotate(-90deg);
  transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1) !important;
  border-radius: 2px !important;
}

.wpc-calc-dti-k4m7-gauge-center {
  position: absolute !important;
  bottom: -10px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: 20px !important;
  height: 20px !important;
  background: var(--wpc-dti-text-dark) !important;
  border-radius: 50% !important;
}

.wpc-calc-dti-k4m7-gauge-labels {
  display: flex !important;
  justify-content: space-between !important;
  width: 100% !important;
  padding: 0 10px !important;
  font-size: 0.8rem !important;
  color: var(--wpc-dti-text-light) !important;
}

.wpc-calc-dti-k4m7-gauge-value {
  font-size: 2.5rem !important;
  font-weight: 800 !important;
  margin-top: 10px !important;
}

.wpc-calc-dti-k4m7-gauge-value.safe { color: var(--wpc-dti-success) !important; }
.wpc-calc-dti-k4m7-gauge-value.warning { color: var(--wpc-dti-warning) !important; }
.wpc-calc-dti-k4m7-gauge-value.danger { color: var(--wpc-dti-danger) !important; }

.wpc-calc-dti-k4m7-status-badge {
  padding: 10px 25px !important;
  border-radius: 25px !important;
  font-size: 1.1rem !important;
  font-weight: 700 !important;
  margin-top: 15px !important;
}

.wpc-calc-dti-k4m7-status-badge.safe {
  background: rgba(37,211,102,0.15) !important;
  color: var(--wpc-dti-success) !important;
}

.wpc-calc-dti-k4m7-status-badge.warning {
  background: rgba(243,156,18,0.15) !important;
  color: var(--wpc-dti-warning) !important;
}

.wpc-calc-dti-k4m7-status-badge.danger {
  background: rgba(231,76,60,0.15) !important;
  color: var(--wpc-dti-danger) !important;
}

.wpc-calc-dti-k4m7-recommendation {
  background: var(--wpc-dti-primary-light) !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  padding: 20px !important;
  margin-top: 20px !important;
  border-right: 4px solid var(--wpc-dti-primary) !important;
}

.wpc-calc-dti-k4m7-recommendation-title {
  font-size: 1.1rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  margin-bottom: 10px !important;
}

.wpc-calc-dti-k4m7-recommendation-text {
  font-size: 1rem !important;
  color: var(--wpc-dti-text-dark) !important;
  line-height: 1.7 !important;
}

.wpc-calc-dti-k4m7-recommendation-value {
  font-size: 1.4rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-success) !important;
}

/* Info Box */
.wpc-calc-dti-k4m7-info-box {
  background: #fff9e6 !important;
  border: 1px solid #ffeaa7 !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  padding: 15px !important;
  margin-top: 20px !important;
  display: flex !important;
  gap: 12px !important;
  align-items: flex-start !important;
}

.wpc-calc-dti-k4m7-info-icon { font-size: 1.5rem !important; }

.wpc-calc-dti-k4m7-info-text {
  font-size: 0.9rem !important;
  color: var(--wpc-dti-text-dark) !important;
  line-height: 1.6 !important;
}

/* AWG Section */
.wpc-calc-dti-k4m7-awg-section {
  background: linear-gradient(135deg, var(--wpc-dti-primary) 0%, var(--wpc-dti-primary-dark) 100%) !important;
  padding: 40px 20px !important;
  margin: 40px 0 !important;
  border-radius: var(--wpc-dti-radius-lg) !important;
}

.wpc-calc-dti-k4m7-awg-container { max-width: 800px !important; margin: 0 auto !important; }

.wpc-calc-dti-k4m7-cta-buttons-wrapper {
  display: flex !important;
  flex-direction: column !important;
  gap: 15px !important;
  margin-bottom: 20px !important;
}

.wpc-calc-dti-k4m7-cta-btn {
  display: block !important;
  width: 100% !important;
  padding: 18px 30px !important;
  background: var(--wpc-dti-danger) !important;
  color: var(--wpc-dti-white) !important;
  border: none !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  font-family: inherit !important;
  font-size: 1.2rem !important;
  font-weight: 700 !important;
  cursor: pointer !important;
  transition: var(--wpc-dti-transition) !important;
  text-align: center !important;
  text-decoration: none !important;
}

.wpc-calc-dti-k4m7-cta-btn:hover {
  background: #c0392b !important;
  transform: translateY(-2px) !important;
}

.wpc-calc-dti-k4m7-cta-embed {
  display: block !important;
  width: 100% !important;
  padding: 15px 25px !important;
  background: rgba(255,255,255,0.15) !important;
  color: var(--wpc-dti-white) !important;
  border: 2px solid rgba(255,255,255,0.3) !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  font-family: inherit !important;
  font-size: 1rem !important;
  font-weight: 600 !important;
  cursor: pointer !important;
  transition: var(--wpc-dti-transition) !important;
  text-align: center !important;
}

.wpc-calc-dti-k4m7-cta-embed:hover {
  background: rgba(255,255,255,0.25) !important;
}

.wpc-calc-dti-k4m7-awg-content {
  display: none !important;
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  padding: 20px !important;
  margin-top: 20px !important;
}

.wpc-calc-dti-k4m7-awg-content.active { display: block !important; }

/* FAQ Section */
.wpc-calc-dti-k4m7-faq-section {
  background: var(--wpc-dti-bg-light) !important;
  padding: 40px 20px !important;
  margin: 40px 0 !important;
  border-radius: var(--wpc-dti-radius-lg) !important;
}

.wpc-calc-dti-k4m7-faq-title {
  font-size: 1.8rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  text-align: center !important;
  margin-bottom: 30px !important;
}

.wpc-calc-dti-k4m7-faq-item {
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  margin-bottom: 12px !important;
  box-shadow: var(--wpc-dti-shadow-sm) !important;
  overflow: hidden !important;
}

.wpc-calc-dti-k4m7-faq-question {
  width: 100% !important;
  padding: 18px 20px !important;
  background: transparent !important;
  border: none !important;
  text-align: right !important;
  font-family: inherit !important;
  font-size: 1.05rem !important;
  font-weight: 600 !important;
  color: var(--wpc-dti-text-dark) !important;
  cursor: pointer !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  transition: var(--wpc-dti-transition) !important;
}

.wpc-calc-dti-k4m7-faq-question:hover {
  background: var(--wpc-dti-primary-light) !important;
}

.wpc-calc-dti-k4m7-faq-icon {
  font-size: 1.2rem !important;
  transition: transform 0.3s ease !important;
}

.wpc-calc-dti-k4m7-faq-item.active .wpc-calc-dti-k4m7-faq-icon {
  transform: rotate(180deg) !important;
}

.wpc-calc-dti-k4m7-faq-answer {
  display: none !important;
  padding: 0 20px 18px 20px !important;
  color: var(--wpc-dti-text-light) !important;
  line-height: 1.7 !important;
}

.wpc-calc-dti-k4m7-faq-item.active .wpc-calc-dti-k4m7-faq-answer {
  display: block !important;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .wpc-calc-dti-k4m7-title { font-size: 1.7rem !important; }
  .wpc-calc-dti-k4m7-tab-btn { flex: 1 1 45% !important; min-width: auto !important; padding: 12px 10px !important; font-size: 0.9rem !important; }
  .wpc-calc-dti-k4m7-tab-content { padding: 20px 15px !important; }
  .wpc-calc-dti-k4m7-form-grid { grid-template-columns: 1fr !important; gap: 20px !important; }
  .wpc-calc-dti-k4m7-results-main { grid-template-columns: 1fr !important; }
  .wpc-calc-dti-k4m7-gauge { width: 160px !important; height: 100px !important; }
  .wpc-calc-dti-k4m7-gauge-bg { width: 160px !important; height: 80px !important; }
  .wpc-calc-dti-k4m7-gauge-cover { width: 140px !important; height: 70px !important; left: 10px !important; }
  .wpc-calc-dti-k4m7-gauge-needle { height: 60px !important; }
}

@media (max-width: 480px) {
  .wpc-calc-dti-k4m7-wrapper { padding: 10px !important; }
  .wpc-calc-dti-k4m7-title { font-size: 1.4rem !important; }
  .wpc-calc-dti-k4m7-tab-btn { flex: 1 1 100% !important; }
  .wpc-calc-dti-k4m7-tab-content { padding: 15px 12px !important; }
  .wpc-calc-dti-k4m7-gauge-value { font-size: 2rem !important; }
  .wpc-calc-dti-k4m7-result-value { font-size: 1.4rem !important; }
}

/* Embed Section */
.wpc-calc-dti-k4m7-embed-section {
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%) !important;
  padding: 40px 25px !important;
  margin: 40px 0 !important;
  border-radius: var(--wpc-dti-radius-lg) !important;
  border: 2px solid var(--wpc-dti-primary-light) !important;
}

.wpc-calc-dti-k4m7-embed-title {
  font-size: 1.6rem !important;
  font-weight: 700 !important;
  color: var(--wpc-dti-primary) !important;
  text-align: center !important;
  margin-bottom: 25px !important;
}

.wpc-calc-dti-k4m7-embed-value-box {
  background: var(--wpc-dti-white) !important;
  padding: 20px !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  margin-bottom: 25px !important;
  border-right: 4px solid var(--wpc-dti-success) !important;
}

.wpc-calc-dti-k4m7-embed-btn-large {
  display: block !important;
  width: 100% !important;
  max-width: 500px !important;
  margin: 20px auto !important;
  padding: 18px 30px !important;
  background: var(--wpc-dti-success) !important;
  color: var(--wpc-dti-white) !important;
  border: none !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  font-family: inherit !important;
  font-size: 1.1rem !important;
  font-weight: 700 !important;
  cursor: pointer !important;
  transition: var(--wpc-dti-transition) !important;
}

.wpc-calc-dti-k4m7-embed-btn-large:hover {
  background: #1ea855 !important;
  transform: translateY(-2px) !important;
}

.wpc-calc-dti-k4m7-color-picker {
  text-align: center !important;
  margin: 30px 0 !important;
}

.wpc-calc-dti-k4m7-color-buttons {
  display: flex !important;
  flex-wrap: wrap !important;
  justify-content: center !important;
  gap: 12px !important;
}

.wpc-calc-dti-k4m7-color-btn {
  width: 50px !important;
  height: 50px !important;
  border-radius: 50% !important;
  border: 3px solid var(--wpc-dti-white) !important;
  cursor: pointer !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
  transition: var(--wpc-dti-transition) !important;
}

.wpc-calc-dti-k4m7-color-btn:hover {
  transform: scale(1.15) !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
}

.wpc-calc-dti-k4m7-color-custom {
  width: 50px !important;
  height: 50px !important;
  border-radius: 50% !important;
  border: 3px dashed var(--wpc-dti-border) !important;
  cursor: pointer !important;
  padding: 0 !important;
}

.wpc-calc-dti-k4m7-preview-area {
  margin-top: 30px !important;
  padding: 25px !important;
  background: var(--wpc-dti-white) !important;
  border-radius: var(--wpc-dti-radius-md) !important;
  border: 2px solid var(--wpc-dti-primary) !important;
}

.wpc-calc-dti-k4m7-preview-area h4 {
  text-align: center !important;
  margin-bottom: 20px !important;
  color: var(--wpc-dti-primary) !important;
}

.wpc-calc-dti-k4m7-preview-container {
  border: 1px solid var(--wpc-dti-border) !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  margin-bottom: 20px !important;
  overflow: visible !important;
}

.wpc-calc-dti-k4m7-embed-btn-copy {
  display: block !important;
  width: 100% !important;
  padding: 15px 25px !important;
  background: var(--wpc-dti-primary) !important;
  color: var(--wpc-dti-white) !important;
  border: none !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  font-family: inherit !important;
  font-size: 1rem !important;
  font-weight: 700 !important;
  cursor: pointer !important;
  transition: var(--wpc-dti-transition) !important;
}

.wpc-calc-dti-k4m7-embed-btn-copy:hover {
  background: var(--wpc-dti-primary-dark) !important;
}

.wpc-calc-dti-k4m7-embed-terms {
  margin-top: 25px !important;
  padding: 15px !important;
  background: #fff3cd !important;
  border-radius: var(--wpc-dti-radius-sm) !important;
  border: 1px solid #ffc107 !important;
}

.wpc-calc-dti-k4m7-embed-terms h4 {
  margin: 0 0 10px 0 !important;
  color: #856404 !important;
}

.wpc-calc-dti-k4m7-embed-terms p {
  margin: 0 !important;
  font-size: 0.9rem !important;
  color: #856404 !important;
}

@media (max-width: 768px) {
  .wpc-calc-dti-k4m7-embed-section { padding: 25px 15px !important; }
  .wpc-calc-dti-k4m7-embed-title { font-size: 1.3rem !important; }
  .wpc-calc-dti-k4m7-color-btn { width: 40px !important; height: 40px !important; }
}
</style>

<div class="wpc-calc-dti-k4m7-wrapper" id="wpc-calc-dti-k4m7-main">

  <!-- ×›×•×ª×¨×ª ×¨××©×™×ª -->
  <div class="wpc-calc-dti-k4m7-title-container">
    <h1 class="wpc-calc-dti-k4m7-title">ğŸ¦ ××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” </h1>
    <p class="wpc-calc-dti-k4m7-subtitle">×‘×“×•×§ ×× ××ª×” ×¢×•××“ ×‘××’×‘×œ×•×ª ×‘× ×§ ×™×©×¨××œ ×œ××™×©×•×¨ ×”×œ×•×•××”</p>
    <p class="wpc-calc-dti-k4m7-update-date"><strong>×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”:</strong> [current_date format="F Y" hebrew="true"]</p>
  </div>

  <!-- ××—×©×‘×•×Ÿ -->
  <div class="wpc-calc-dti-k4m7-calculator" id="wpc-calc-dti-k4m7-calculator">
    
    <!-- ×œ×©×•× ×™×•×ª -->
    <div class="wpc-calc-dti-k4m7-tabs-nav">
      <button class="wpc-calc-dti-k4m7-tab-btn active" data-action="switch-tab" data-tab="basic">
        <span class="wpc-calc-dti-k4m7-tab-icon">ğŸ§®</span>
        <span>×‘×“×™×§×ª ×™×—×¡ ×”×—×–×¨</span>
      </button>
      <button class="wpc-calc-dti-k4m7-tab-btn" data-action="switch-tab" data-tab="max-loan">
        <span class="wpc-calc-dti-k4m7-tab-icon">ğŸ’°</span>
        <span>×”×œ×•×•××” ××§×¡×™××œ×™×ª</span>
      </button>
      <button class="wpc-calc-dti-k4m7-tab-btn" data-action="switch-tab" data-tab="simulator">
        <span class="wpc-calc-dti-k4m7-tab-icon">ğŸ“Š</span>
        <span>×¡×™××•×œ×˜×•×¨ ×ª×¨×—×™×©×™×</span>
      </button>
    </div>

    <!-- ×ª×•×›×Ÿ ×œ×©×•× ×™×ª 1: ×‘×“×™×§×ª ×™×—×¡ ×”×—×–×¨ -->
    <div class="wpc-calc-dti-k4m7-tab-content active" id="tab-basic">
      <h3 class="wpc-calc-dti-k4m7-tab-title">ğŸ“‹ ×‘×“×™×§×ª ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×”</h3>
      
      <div class="wpc-calc-dti-k4m7-form-grid">
        <!-- ×”×›× ×¡×” × ×˜×• -->
        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ’µ</span> ×”×›× ×¡×” × ×˜×• ×—×•×“×©×™×ª (×©×œ ×›×œ ××©×§ ×”×‘×™×ª)
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="basic-income-value">20,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="basic-income-slider" min="5000" max="80000" step="500" value="20000">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>5,000 â‚ª</span>
              <span>80,000 â‚ª</span>
            </div>
          </div>
        </div>

        <!-- ×”×—×–×¨×™ ×”×œ×•×•××•×ª ×§×™×™××™× -->
        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ“‘</span> ×¡×”"×› ×”×—×–×¨×™ ×”×œ×•×•××•×ª ×§×™×™××™× (××©×›× ×ª×, ×¨×›×‘, ××©×¨××™)
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="basic-existing-value">3,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="basic-existing-slider" min="0" max="30000" step="100" value="3000">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>0 â‚ª</span>
              <span>30,000 â‚ª</span>
            </div>
          </div>
        </div>

        <!-- ×”×—×–×¨ ×”×œ×•×•××” ×—×“×©×” -->
        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ†•</span> ×”×—×–×¨ ×—×•×“×©×™ ×¦×¤×•×™ ×©×œ ×”×”×œ×•×•××” ×”×—×“×©×”
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="basic-new-value">2,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="basic-new-slider" min="0" max="20000" step="100" value="2000">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>0 â‚ª</span>
              <span>20,000 â‚ª</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ××“ ×‘×˜×™×—×•×ª -->
      <div class="wpc-calc-dti-k4m7-gauge-container">
        <h4 style="margin: 0 0 20px 0; color: var(--wpc-dti-primary);">ğŸ“Š ××“ ×‘×˜×™×—×•×ª ×™×—×¡ ×”×”×—×–×¨</h4>
        <div class="wpc-calc-dti-k4m7-gauge">
          <div class="wpc-calc-dti-k4m7-gauge-bg"></div>
          <div class="wpc-calc-dti-k4m7-gauge-cover"></div>
          <div class="wpc-calc-dti-k4m7-gauge-needle" id="basic-gauge-needle"></div>
          <div class="wpc-calc-dti-k4m7-gauge-center"></div>
        </div>
        <div class="wpc-calc-dti-k4m7-gauge-labels">
          <span>0%</span>
          <span>30%</span>
          <span>40%</span>
          <span>50%+</span>
        </div>
        <div class="wpc-calc-dti-k4m7-gauge-value safe" id="basic-dti-value">25%</div>
        <div class="wpc-calc-dti-k4m7-status-badge safe" id="basic-status-badge">âœ… ××–×•×¨ ×‘×˜×•×—</div>
      </div>

      <!-- ×ª×•×¦××•×ª -->
      <div class="wpc-calc-dti-k4m7-results">
        <h4 class="wpc-calc-dti-k4m7-results-title">ğŸ“ˆ ×ª×•×¦××•×ª ×”×—×™×©×•×‘</h4>
        <div class="wpc-calc-dti-k4m7-results-main">
          <div class="wpc-calc-dti-k4m7-result-card">
            <div class="wpc-calc-dti-k4m7-result-label">×¡×”"×› ×”×—×–×¨×™× ×—×•×“×©×™×™×</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="basic-total-payments">5,000 â‚ª</div>
          </div>
          <div class="wpc-calc-dti-k4m7-result-card">
            <div class="wpc-calc-dti-k4m7-result-label">×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×”</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="basic-dti-percent">25%</div>
          </div>
          <div class="wpc-calc-dti-k4m7-result-card">
            <div class="wpc-calc-dti-k4m7-result-label">× ×•×ª×¨ ×œ×”×•×¦××•×ª ××—×™×”</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="basic-remaining">15,000 â‚ª</div>
          </div>
        </div>

        <div class="wpc-calc-dti-k4m7-recommendation" id="basic-recommendation">
          <div class="wpc-calc-dti-k4m7-recommendation-title">ğŸ’¡ ×”××œ×¦×”</div>
          <div class="wpc-calc-dti-k4m7-recommendation-text">
            ×¢× ×™×—×¡ ×”×—×–×¨ ×©×œ <span id="rec-dti">25%</span>, ×¡×™×›×•×™×™ ×”××™×©×•×¨ ×©×œ×š ×’×‘×•×”×™×.<br>
            <strong>×”×—×–×¨ ××§×¡×™××œ×™ ××•××œ×¥:</strong> <span class="wpc-calc-dti-k4m7-recommendation-value" id="rec-max-payment">8,000 â‚ª</span> ×œ×—×•×“×©
          </div>
        </div>
      </div>

      <div class="wpc-calc-dti-k4m7-info-box">
        <span class="wpc-calc-dti-k4m7-info-icon">â„¹ï¸</span>
        <div class="wpc-calc-dti-k4m7-info-text">
          <strong>××” ×–×” ×™×—×¡ ×”×—×–×¨ (DTI)?</strong><br>
          ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” ××—×•×©×‘ ×¢×œ ×™×“×™ ×—×œ×•×§×ª ×¡×š ×›×œ ×”×”×—×–×¨×™× ×”×—×•×“×©×™×™× ×‘×”×›× ×¡×” ×”× ×˜×•. ×‘× ×§ ×™×©×¨××œ ××’×‘×™×œ ×™×—×¡ ×–×” ×‘×“×¨×š ×›×œ×œ ×œ-40%, ×•×‘××©×›× ×ª××•×ª ××•××œ×¥ ×œ× ×œ×¢×‘×•×¨ 33%.
        </div>
      </div>
    </div>

    <!-- ×ª×•×›×Ÿ ×œ×©×•× ×™×ª 2: ×”×œ×•×•××” ××§×¡×™××œ×™×ª -->
    <div class="wpc-calc-dti-k4m7-tab-content" id="tab-max-loan">
      <h3 class="wpc-calc-dti-k4m7-tab-title">ğŸ’° ×—×™×©×•×‘ ×”×œ×•×•××” ××§×¡×™××œ×™×ª ××¤×©×¨×™×ª</h3>
      
      <div class="wpc-calc-dti-k4m7-form-grid">
        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ’µ</span> ×”×›× ×¡×” × ×˜×• ×—×•×“×©×™×ª (×©×œ ×›×œ ××©×§ ×”×‘×™×ª)
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="max-income-value">20,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="max-income-slider" min="5000" max="80000" step="500" value="20000">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>5,000 â‚ª</span>
              <span>80,000 â‚ª</span>
            </div>
          </div>
        </div>

        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ“‘</span> ×¡×”"×› ×”×—×–×¨×™ ×”×œ×•×•××•×ª ×§×™×™××™×
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="max-existing-value">3,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="max-existing-slider" min="0" max="30000" step="100" value="3000">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>0 â‚ª</span>
              <span>30,000 â‚ª</span>
            </div>
          </div>
        </div>

        <div class="wpc-calc-dti-k4m7-form-group">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ“…</span> ×ª×§×•×¤×ª ×”×”×œ×•×•××” (×©× ×™×)
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="max-years-value">5 ×©× ×™×</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="max-years-slider" min="1" max="30" step="1" value="5">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>×©× ×”</span>
              <span>30 ×©× ×™×</span>
            </div>
          </div>
        </div>

        <div class="wpc-calc-dti-k4m7-form-group">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ“Š</span> ×¨×™×‘×™×ª ×©× ×ª×™×ª ××©×•×¢×¨×ª (%)
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="max-rate-value">6%</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="max-rate-slider" min="2" max="15" step="0.25" value="6">
            <div class="wpc-calc-dti-k4m7-slider-range">
              <span>2%</span>
              <span>15%</span>
            </div>
          </div>
        </div>
      </div>

      <div class="wpc-calc-dti-k4m7-results">
        <h4 class="wpc-calc-dti-k4m7-results-title">ğŸ“ˆ ×¡×›×•× ×”×œ×•×•××” ××§×¡×™××œ×™ ×œ×¤×™ ×™×—×¡ ×”×—×–×¨</h4>
        <div class="wpc-calc-dti-k4m7-results-main">
          <div class="wpc-calc-dti-k4m7-result-card" style="background: rgba(37,211,102,0.1) !important; border: 2px solid var(--wpc-dti-success) !important;">
            <div class="wpc-calc-dti-k4m7-result-label" style="color: var(--wpc-dti-success) !important;">ğŸŸ¢ ×™×—×¡ 30% (××•××œ×¥)</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="max-loan-30" style="color: var(--wpc-dti-success) !important;">150,000 â‚ª</div>
          </div>
          <div class="wpc-calc-dti-k4m7-result-card" style="background: rgba(243,156,18,0.1) !important; border: 2px solid var(--wpc-dti-warning) !important;">
            <div class="wpc-calc-dti-k4m7-result-label" style="color: var(--wpc-dti-warning) !important;">ğŸŸ¡ ×™×—×¡ 40% (××§×¡×™××•×)</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="max-loan-40" style="color: var(--wpc-dti-warning) !important;">200,000 â‚ª</div>
          </div>
          <div class="wpc-calc-dti-k4m7-result-card">
            <div class="wpc-calc-dti-k4m7-result-label">×”×—×–×¨ ×—×•×“×©×™ ××§×¡×™××œ×™ (40%)</div>
            <div class="wpc-calc-dti-k4m7-result-value" id="max-payment-allowed">5,000 â‚ª</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ×ª×•×›×Ÿ ×œ×©×•× ×™×ª 3: ×¡×™××•×œ×˜×•×¨ ×ª×¨×—×™×©×™× -->
    <div class="wpc-calc-dti-k4m7-tab-content" id="tab-simulator">
      <h3 class="wpc-calc-dti-k4m7-tab-title">ğŸ“Š ×¡×™××•×œ×˜×•×¨ ×ª×¨×—×™×©×™× - ××” ×™×§×¨×” ××?</h3>
      
      <div class="wpc-calc-dti-k4m7-form-grid">
        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ’µ</span> ×”×›× ×¡×” × ×˜×• × ×•×›×—×™×ª
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="sim-income-value">20,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="sim-income-slider" min="5000" max="80000" step="500" value="20000">
          </div>
        </div>

        <div class="wpc-calc-dti-k4m7-form-group full-width">
          <label class="wpc-calc-dti-k4m7-label">
            <span>ğŸ“‘</span> ×”×—×–×¨×™× ×§×™×™××™×
          </label>
          <div class="wpc-calc-dti-k4m7-slider-container">
            <div class="wpc-calc-dti-k4m7-slider-value" id="sim-existing-value">5,000 â‚ª</div>
            <input type="range" class="wpc-calc-dti-k4m7-slider" id="sim-existing-slider" min="0" max="30000" step="100" value="5000">
          </div>
        </div>
      </div>

      <div class="wpc-calc-dti-k4m7-results">
        <h4 class="wpc-calc-dti-k4m7-results-title">ğŸ”® ×ª×¨×—×™×©×™× ××¤×©×¨×™×™×</h4>
        
        <div style="display: grid; gap: 15px;">
          <div class="wpc-calc-dti-k4m7-result-card" style="text-align: right !important;">
            <strong>ğŸ“ˆ ×ª×¨×—×™×© 1: ×”×¢×œ××ª ××©×›×•×¨×ª ×‘-20%</strong>
            <p style="margin: 10px 0 0 0; color: var(--wpc-dti-text-light);">
              ×”×›× ×¡×” ×—×“×©×”: <span id="sim-scenario1-income">24,000 â‚ª</span> | 
              ×™×—×¡ ×”×—×–×¨: <span id="sim-scenario1-dti" style="font-weight: bold; color: var(--wpc-dti-success);">20.8%</span>
            </p>
          </div>
          
          <div class="wpc-calc-dti-k4m7-result-card" style="text-align: right !important;">
            <strong>ğŸ’³ ×ª×¨×—×™×© 2: ×¡×’×™×¨×ª ×”×œ×•×•××” ×§×™×™××ª ×©×œ 2,000 â‚ª</strong>
            <p style="margin: 10px 0 0 0; color: var(--wpc-dti-text-light);">
              ×”×—×–×¨×™× ×—×“×©×™×: <span id="sim-scenario2-payments">3,000 â‚ª</span> | 
              ×™×—×¡ ×”×—×–×¨: <span id="sim-scenario2-dti" style="font-weight: bold; color: var(--wpc-dti-success);">15%</span>
            </p>
          </div>
          
          <div class="wpc-calc-dti-k4m7-result-card" style="text-align: right !important;">
            <strong>ğŸ  ×ª×¨×—×™×© 3: ×œ×§×™×—×ª ××©×›× ×ª× ×¢× ×”×—×–×¨ 4,000 â‚ª</strong>
            <p style="margin: 10px 0 0 0; color: var(--wpc-dti-text-light);">
              ×”×—×–×¨×™× ×—×“×©×™×: <span id="sim-scenario3-payments">9,000 â‚ª</span> | 
              ×™×—×¡ ×”×—×–×¨: <span id="sim-scenario3-dti" style="font-weight: bold; color: var(--wpc-dti-warning);">45%</span>
            </p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- ××–×•×¨ ×‘×“×™×§×ª ×–×›××•×ª -->
  <div class="wpc-calc-dti-k4m7-awg-section">
    <div class="wpc-calc-dti-k4m7-awg-container">
      <div class="wpc-calc-dti-k4m7-cta-buttons-wrapper">
        <button class="wpc-calc-dti-k4m7-cta-btn" data-action="open-awg">
          ğŸ¯ ×‘×“×•×§ ×–×›××•×ª ×œ×”×œ×•×•××” ×¢×›×©×™×• - ×§×‘×œ ×”×¦×¢×” ××™×™×“×™×ª!
        </button>
        <button class="wpc-calc-dti-k4m7-cta-embed" data-action="scroll-to-embed">
          ğŸ ×¨×•×¦×” ×œ×”×•×¡×™×£ ××ª ×”××—×©×‘×•×Ÿ ×‘×—×™× × ×œ××ª×¨×š? ×œ×—×¥ ×›××Ÿ!
        </button>
      </div>
      <div class="wpc-calc-dti-k4m7-awg-content" id="awg-content">
        <div class="wpc-calc-dti-k4m7-shortcode-item">
          [awg postid="32400"]
        </div>
      </div>
    </div>
  </div>

  <!-- ××–×•×¨ ×”×˜××¢×” -->
  <div class="wpc-calc-dti-k4m7-embed-section" id="embed-section">
    <h2 class="wpc-calc-dti-k4m7-embed-title">ğŸ ×¨×•×¦×™× ×œ×”×˜××™×¢ ××ª ××—×©×‘×•×Ÿ ×™×—×¡ ×”×”×—×–×¨ (DTI) ×‘××ª×¨ ×©×œ×›×? ×—×™× × ×œ×—×œ×•×˜×™×Ÿ!</h2>
    
    <div class="wpc-calc-dti-k4m7-embed-value-box">
      <p>
        <strong>ğŸ’ ×× ×—× ×• × ×•×ª× ×™× ×œ×›× ××ª ××—×©×‘×•×Ÿ ×™×—×¡ ×”×”×—×–×¨ (DTI) ×”××ª×§×“× ×”×–×” ×‘×—×™× ×!</strong><br>
        ×ª××•×¨×ª ×§×™×©×•×¨ ×§×¨×“×™×˜ ×§×˜×Ÿ, ×ª×§×‘×œ×• ××—×©×‘×•×Ÿ ××§×¦×•×¢×™ ×¢× 3 ×œ×©×•× ×™×•×ª, ××“ ×‘×˜×™×—×•×ª ×•×™×–×•××œ×™, ×•×—×™×©×•×‘×™× ××“×•×™×§×™× ×œ×¤×™ ××’×‘×œ×•×ª ×‘× ×§ ×™×©×¨××œ.<br>
        <strong>×©×•×•×™ ×”××—×©×‘×•×Ÿ:</strong> ××¢×œ â‚ª12,000 ×‘×¤×™×ª×•×— ğŸ’° | <strong>××” ×©×©×™×œ××ª×:</strong> â‚ª0 ğŸ‰
      </p>
    </div>
    
    <!-- ×§×˜×¢ SEO -->
    <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 25px; border-radius: 12px; margin: 25px 0; border: 2px solid #0ea5e9;">
      <h3 style="color: #0369a1; margin-top: 0;">ğŸš€ ×œ××” ×œ×”×˜××™×¢ ××—×©×‘×•×Ÿ DTI ×‘××ª×¨? ×–×” ××©×¤×¨ ××ª ×”-SEO!</h3>
      <p style="line-height: 1.8; color: #222; margin-bottom: 15px;">
        <strong>×”×•×¡×¤×ª ××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” ×”×™× ×“×¨×š ××¦×•×™× ×ª ×œ×©×¤×¨ ××ª ×“×™×¨×•×’ ×”××ª×¨ ×©×œ×›×!</strong>
      </p>
      <ul style="line-height: 2; color: #222; margin: 0; padding-right: 20px;">
        <li>ğŸ“ˆ <strong>×ª×•×›×Ÿ ××™× ×˜×¨××§×˜×™×‘×™ ××™×›×•×ª×™</strong> - ×’×•×’×œ ××•×”×‘×ª ×“×¤×™× ×¢× ×›×œ×™× ×©×™××•×©×™×™×</li>
        <li>â±ï¸ <strong>×–××Ÿ ×©×”×™×™×” ××¨×•×š ×™×•×ª×¨</strong> - ××‘×§×¨×™× × ×©××¨×™× ×‘×“×£ ×œ×”×©×ª××© ×‘××—×©×‘×•×Ÿ</li>
        <li>ğŸ”— <strong>××™×œ×•×ª ××¤×ª×— ×¨×œ×•×•× ×˜×™×•×ª</strong> - ×”××—×©×‘×•×Ÿ ×›×•×œ×œ ××™×œ×™× ×›××• "×™×—×¡ ×”×—×–×¨, DTI, ××™×©×•×¨ ×”×œ×•×•××”, ×”×œ×•×•××” ×œ×¤×™ ×”×›× ×¡×”, ×‘× ×§ ×™×©×¨××œ"</li>
        <li>ğŸ¯ <strong>××—×©×‘×•×Ÿ ×‘×—×™× × ×œ×”×˜××¢×”</strong> - ×ª×•×›×Ÿ ×™×™×—×•×“×™ ×‘×œ×™ ×¢×œ×•×ª ×¤×™×ª×•×—</li>
        <li>ğŸ’¼ <strong>××§×¦×•×¢×™×•×ª ×•×××™× ×•×ª</strong> - ××ª×¨ ×¢× ×›×œ×™ ××—×©×‘×•×Ÿ × ×¨××” ××§×¦×•×¢×™ ×™×•×ª×¨</li>
        <li>ğŸ“± <strong>Mobile Friendly</strong> - ××—×©×‘×•×Ÿ responsive ××œ×</li>
      </ul>
      <p style="margin-top: 20px; margin-bottom: 0; padding: 15px; background: white; border-radius: 8px; color: #0369a1; font-weight: 700;">
        ğŸ’¡ <strong>×˜×™×¤ SEO:</strong> ×”×•×¡×™×¤×• ××ª ×”××—×©×‘×•×Ÿ ×‘×“×¤×™× ×¨×œ×•×•× ×˜×™×™× ×›××• "×‘×“×™×§×ª ×–×›××•×ª ×œ×”×œ×•×•××”, ××©×›× ×ª×, ×”×œ×•×•××•×ª ×œ×¢×¡×§×™×, ×™×™×¢×•×¥ ×¤×™× × ×¡×™" - 
        ×–×” ×™×—×–×§ ××ª ×”×“×£ ×‘×“×™×•×§ ×‘××™×œ×•×ª ×”××¤×ª×— ×©××ª× ×¨×•×¦×™× ×œ×“×¨×’ ×¢×œ×™×”×Ÿ!
      </p>
    </div>
    
    <h3>ğŸ“‹ ××™×š ××•×¡×™×¤×™×? (3 ×“×§×•×ª ×‘×œ×‘×“)</h3>
    <ol style="text-align: right; margin: 20px 0; padding-right: 25px;">
      <li><strong>×‘×—×¨×• ×¦×‘×¢</strong> ××”×¢×™×’×•×œ×™× ×œ××˜×” ğŸ‘‡</li>
      <li><strong>×œ×—×¦×•</strong> ×¢×œ "×”×¢×ª×§ ×§×•×“ ×¢× ×”×¦×‘×¢ ×”× ×‘×—×¨"</li>
      <li><strong>×”×“×‘×™×§×•</strong> ×‘×¢×•×¨×š ×•×•×¨×“×¤×¨×¡ ×‘××¦×‘ ×˜×§×¡×˜/HTML</li>
      <li><strong>×¤×¨×¡××•!</strong> ×”××—×©×‘×•×Ÿ ×™×¢×‘×•×“ ××™×“ âœ¨</li>
    </ol>
    
    <button class="wpc-calc-dti-k4m7-embed-btn-large" data-action="copy-embed-code">
      ğŸ“‹ ×”×¢×ª×§ ×§×•×“ ××œ× (×¦×‘×¢ ×‘×¨×™×¨×ª ××—×“×œ)
    </button>
    
    <div class="wpc-calc-dti-k4m7-color-picker">
      <p style="margin-bottom: 15px; font-weight: 600;">ğŸ¨ ×‘×—×¨ ×¦×‘×¢ ×œ××—×©×‘×•×Ÿ:</p>
      <div class="wpc-calc-dti-k4m7-color-buttons">
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#1e5490" data-name="×›×—×•×œ ××§×¦×•×¢×™" title="×›×—×•×œ ××§×¦×•×¢×™ ğŸ’™" style="background: #1e5490;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#10b981" data-name="×™×¨×•×§ ×¦××™×—×”" title="×™×¨×•×§ ×¦××™×—×” ğŸ’š" style="background: #10b981;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#ef4444" data-name="××“×•× ×× ×¨×’×˜×™" title="××“×•× ×× ×¨×’×˜×™ â¤ï¸" style="background: #ef4444;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#8b5cf6" data-name="×¡×’×•×œ ×™×•×§×¨×ª×™" title="×¡×’×•×œ ×™×•×§×¨×ª×™ ğŸ’œ" style="background: #8b5cf6;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#f59e0b" data-name="×›×ª×•× ×“×™× ××™" title="×›×ª×•× ×“×™× ××™ ğŸ§¡" style="background: #f59e0b;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#ec4899" data-name="×•×¨×•×“ ××•×“×¨× ×™" title="×•×¨×•×“ ××•×“×¨× ×™ ğŸ’—" style="background: #ec4899;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#06b6d4" data-name="×˜×•×¨×§×™×– ×¨×¢× ×Ÿ" title="×˜×•×¨×§×™×– ×¨×¢× ×Ÿ ğŸ©µ" style="background: #06b6d4;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#84cc16" data-name="×œ×™×™× ×¢×–" title="×œ×™×™× ×¢×– ğŸ’›" style="background: #84cc16;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#f97316" data-name="×›×ª×•× ×‘×•×”×§" title="×›×ª×•× ×‘×•×”×§ ğŸ”¥" style="background: #f97316;"></button>
        <button class="wpc-calc-dti-k4m7-color-btn" data-action="preview-color" data-color="#0891b2" data-name="×›×—×•×œ ×™×" title="×›×—×•×œ ×™× ğŸŒŠ" style="background: #0891b2;"></button>
        <input type="color" class="wpc-calc-dti-k4m7-color-custom" id="custom-color-picker" value="#1e5490" title="×‘×—×¨ ×¦×‘×¢ ××•×ª×× ××™×©×™×ª">
      </div>
    </div>
    
    <div class="wpc-calc-dti-k4m7-preview-area" id="preview-area" style="display: none;">
      <h4>ğŸ‘ï¸ ×ª×¦×•×’×” ××§×“×™××” - <span id="preview-color-name">×›×—×•×œ ××§×¦×•×¢×™</span></h4>
      <div class="wpc-calc-dti-k4m7-preview-container" id="preview-container"></div>
      <button class="wpc-calc-dti-k4m7-embed-btn-copy" data-action="copy-preview-code">
        ğŸ“‹ ×”×¢×ª×§ ×§×•×“ ×¢× ×”×¦×‘×¢ ×”× ×‘×—×¨
      </button>
    </div>
    
    <div class="wpc-calc-dti-k4m7-embed-terms">
      <h4>âš ï¸ ×ª× ××™ ×©×™××•×© ×•×–×›×•×™×•×ª ×™×•×¦×¨×™×</h4>
      <p>
        ××—×©×‘×•×Ÿ ×–×” ××•×’×Ÿ ×‘×–×›×•×™×•×ª ×™×•×¦×¨×™× Â© ×•× ×™×ª×Ÿ ×œ×”×•×¡×¤×” ×œ××ª×¨ ×©×œ×›× ×‘×—×™× × ×¨×§ ×ª××•×¨×ª ×”×©××¨×ª ×§×™×©×•×¨ ×”×§×¨×“×™×˜.<br>
        ×”××—×©×‘×•×Ÿ ×›×•×œ×œ ×× ×’× ×•× ×™ ×”×’× ×” ××ª×§×“××™× ×©×™×©×™×‘×• ××•×˜×•××˜×™×ª ××ª ×”×§×¨×“×™×˜ ×× ×™× ×¡×• ×œ×”×¡×™×¨×•.<br>
        <strong>××¡×•×¨ ×‘×”×—×œ×˜:</strong> ×”×¡×¨×ª/×©×™× ×•×™/×”×¡×ª×¨×ª ×§×™×©×•×¨ ×”×§×¨×“×™×˜, ×©×™××•×© ××¡×—×¨×™ ×™×©×™×¨ ×œ×œ× ××™×©×•×¨, ××›×™×¨×ª ×”××—×©×‘×•×Ÿ.
      </p>
    </div>
    
    <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 25px; border-radius: 12px; margin-top: 25px; color: white; text-align: center;">
      <h3 style="color: white; margin: 0 0 15px 0;">ğŸ¯ ×¨×•×¦×™× ××—×©×‘×•×Ÿ ××•×ª×× ××™×©×™×ª ×œ××ª×¨ ×©×œ×›×?</h3>
      <p style="margin: 0 0 15px 0;">×™×© ×œ×›× ×¦×•×¨×š ×‘×œ×•×’×™×§×ª ×—×™×©×•×‘ ×©×•× ×”? ×¢×™×¦×•×‘ ××•×ª××? ×©×“×•×ª × ×•×¡×¤×™×? ×× ×—× ×• × ×©××— ×œ×¤×ª×— ×œ×›× ××—×©×‘×•×Ÿ ×™×™×¢×•×“×™ ×‘×—×™× ×!</p>
      <p style="margin: 0; font-size: 1.1em;">ğŸ“§ ×©×œ×—×• ×œ× ×• ××™×™×œ: <strong>info@loan-israel.co.il</strong><br>×›×ª×‘×•: "×‘×§×©×” ×œ××—×©×‘×•×Ÿ ××•×ª××" + ×ª×™××•×¨ ×§×¦×¨ ğŸ’š</p>
    </div>
  </div>

  <!-- ×©××œ×•×ª × ×¤×•×¦×•×ª -->
  <div class="wpc-calc-dti-k4m7-faq-section">
    <h2 class="wpc-calc-dti-k4m7-faq-title">â“ ×©××œ×•×ª × ×¤×•×¦×•×ª ×¢×œ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×”</h2>
    
    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>××”×• ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (DTI) ×•×œ××” ×”×•× ×—×©×•×‘?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (Debt-to-Income) ×”×•× ××“×“ ×¤×™× × ×¡×™ ×©××—×©×‘ ××ª ××—×•×– ×”×”×›× ×¡×” ×”×—×•×“×©×™×ª ×©××•×§×“×© ×œ×”×—×–×¨×™ ×—×•×‘×•×ª. ×‘× ×§×™× ×•××•×¡×“×•×ª ×¤×™× × ×¡×™×™× ××©×ª××©×™× ×‘××“×“ ×–×” ×›×“×™ ×œ×”×¢×¨×™×š ××ª ×™×›×•×œ×ª ×”×”×—×–×¨ ×©×œ ×”×œ×•×•×”. ×›×›×œ ×©×”×™×—×¡ × ××•×š ×™×•×ª×¨, ×›×š ×”×¡×™×›×•×Ÿ × ××•×š ×™×•×ª×¨ ×•×¡×™×›×•×™×™ ×”××™×©×•×¨ ×’×‘×•×”×™× ×™×•×ª×¨.
      </div>
    </div>

    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>××”×• ×™×—×¡ ×”×”×—×–×¨ ×”××§×¡×™××œ×™ ×©×‘× ×§ ×™×©×¨××œ ×××¤×©×¨?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×‘× ×§ ×™×©×¨××œ ××’×‘×™×œ ××ª ×™×—×¡ ×”×”×—×–×¨ ×”××§×¡×™××œ×™ ×œ-40% ××”×”×›× ×¡×” ×”×¤× ×•×™×”. ×¢× ×–××ª, ×‘××©×›× ×ª××•×ª ××•××œ×¥ ×œ× ×œ×¢×‘×•×¨ 33% ×›×“×™ ×œ×”×©××™×¨ ××¨×•×•×— ×‘×™×˜×—×•×Ÿ ×œ×©×™× ×•×™×™× ×‘×”×›× ×¡×” ××• ×‘×”×•×¦××•×ª. ×—×œ×§ ××”×‘× ×§×™× ××—××™×¨×™× ××£ ×™×•×ª×¨ ×•×“×•×¨×©×™× ×™×—×¡ ×©×œ 30% ××• ×¤×—×•×ª.
      </div>
    </div>

    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>××™×œ×• ×”×—×–×¨×™× × ×›×œ×œ×™× ×‘×—×™×©×•×‘ ×™×—×¡ ×”×”×—×–×¨?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×‘×—×™×©×•×‘ ×™×—×¡ ×”×”×—×–×¨ × ×›×œ×œ×™×: ××©×›× ×ª×, ×”×œ×•×•××•×ª ×‘× ×§××™×•×ª, ×”×œ×•×•××•×ª ×œ×¨×›×‘, ×ª×©×œ×•××™× ×œ×›×¨×˜×™×¡×™ ××©×¨××™ (××™× ×™××•× ××• ×ª×©×œ×•××™× ×§×‘×•×¢×™×), ×”×œ×•×•××•×ª ××§×¨×Ÿ ×”×©×ª×œ××•×ª ××• ×¤× ×¡×™×”, ×•×”×œ×•×•××•×ª ×—×•×¥-×‘× ×§××™×•×ª. ×œ× × ×›×œ×œ×•×ª ×”×•×¦××•×ª ×©×•×˜×¤×•×ª ×›××• ×©×›×™×¨×•×ª, ×‘×™×˜×•×—×™× ××• ×—×©×‘×•× ×•×ª ×—×©××œ.
      </div>
    </div>

    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>××™×š ××¤×©×¨ ×œ×©×¤×¨ ××ª ×™×—×¡ ×”×”×—×–×¨ ×œ×¤× ×™ ×‘×§×©×ª ×”×œ×•×•××”?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×™×© ××¡×¤×¨ ×“×¨×›×™× ×œ×©×¤×¨ ××ª ×™×—×¡ ×”×”×—×–×¨: ×¡×’×™×¨×” ××•×§×“××ª ×©×œ ×”×œ×•×•××•×ª ×§×˜× ×•×ª, ××™×—×•×“ ×”×œ×•×•××•×ª ×œ×”×œ×•×•××” ××—×ª ×¢× ×”×—×–×¨ × ××•×š ×™×•×ª×¨, ×”×’×“×œ×ª ×”×”×›× ×¡×” (×”×¢×œ××”, ×¢×‘×•×“×” × ×•×¡×¤×ª), ×”×•×¡×¤×ª ×œ×•×•×” × ×•×¡×£ (×‘×Ÿ/×‘×ª ×–×•×’), ×”××¨×›×ª ×ª×§×•×¤×ª ×”×”×œ×•×•××” ×”×—×“×©×” ×œ×”×§×˜× ×ª ×”×”×—×–×¨ ×”×—×•×“×©×™, ××• ×”××ª× ×” ×¢×“ ×œ×¡×™×•× ×”×œ×•×•××•×ª ×§×™×™××•×ª.
      </div>
    </div>

    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>××” ×”×”×‘×“×œ ×‘×™×Ÿ ×™×—×¡ ×”×—×–×¨ ×œ×”×œ×•×•××” ×¨×’×™×œ×” ×œ×¢×•××ª ××©×›× ×ª×?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×‘×”×œ×•×•××•×ª ×¨×’×™×œ×•×ª (×¦×¨×›× ×™×•×ª), ×”×‘× ×§×™× ×‘×“×¨×š ×›×œ×œ ×××¤×©×¨×™× ×™×—×¡ ×”×—×–×¨ ×’×‘×•×” ×™×•×ª×¨, ×¢×“ 40%. ×‘××©×›× ×ª××•×ª, ×‘× ×§ ×™×©×¨××œ ××—××™×¨ ×™×•×ª×¨ ×‘×©×œ ×’×•×‘×” ×”×”×œ×•×•××” ×•×ª×§×•×¤×ª ×”×”×—×–×¨ ×”××¨×•×›×”, ×•××•××œ×¥ ×œ×©××•×¨ ×¢×œ ×™×—×¡ ×©×œ 33% ××• ×¤×—×•×ª. ×‘× ×•×¡×£, ×‘××©×›× ×ª× ×™×© ×’× ××’×‘×œ×•×ª ×¢×œ ×©×™×¢×•×¨ ×”××™××•×Ÿ (LTV) ×‘×™×—×¡ ×œ×©×•×•×™ ×”× ×›×¡.
      </div>
    </div>

    <div class="wpc-calc-dti-k4m7-faq-item">
      <button class="wpc-calc-dti-k4m7-faq-question" data-action="toggle-faq">
        <span>×”×× ×™×—×¡ ×”×—×–×¨ ×’×‘×•×” ×‘×”×›×¨×— ××•××¨ ×©×œ× ×™××©×¨×• ×œ×™ ×”×œ×•×•××”?</span>
        <span class="wpc-calc-dti-k4m7-faq-icon">â–¼</span>
      </button>
      <div class="wpc-calc-dti-k4m7-faq-answer">
        ×œ× ×‘×”×›×¨×—. ×™×—×¡ ×”×—×–×¨ ×”×•× ××—×“ ××”×¤×¨××˜×¨×™× ×©×”×‘× ×§ ×‘×•×—×Ÿ, ××š ×œ× ×”×™×—×™×“. ×’×•×¨××™× × ×•×¡×¤×™× ×›×•×œ×œ×™×: ×”×™×¡×˜×•×¨×™×™×ª ××©×¨××™, ×™×¦×™×‘×•×ª ×ª×¢×¡×•×§×”, ×‘×˜×—×•× ×•×ª, ×¡×•×’ ×”×”×œ×•×•××”, ×•×”×ª× ×”×œ×•×ª ×‘× ×§××™×ª ×›×œ×œ×™×ª. ×¢× ×–××ª, ×™×—×¡ ×”×—×–×¨ ××¢×œ 40% ×™×§×©×” ×××•×“ ×¢×œ ×§×‘×œ×ª ××™×©×•×¨, ×‘××™×•×—×“ ×‘×‘× ×§×™×.
      </div>
    </div>
  </div>

</div>

<script>
(function() {
    'use strict';
    
    const namespace = 'WPC_CalcDTI_K4M7';
    if (window[namespace]) return;
    
    const container = document.getElementById('wpc-calc-dti-k4m7-main');
    if (!container) return;
    
    // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
    function formatCurrency(num) {
        return Math.round(num).toLocaleString('he-IL') + ' â‚ª';
    }
    
    function formatPercent(num) {
        return num.toFixed(1) + '%';
    }
    
    function getElement(id) {
        return document.getElementById(id);
    }
    
    // ×—×™×©×•×‘ ×ª×©×œ×•× ×—×•×“×©×™
    function calcMonthlyPayment(principal, annualRate, months) {
        const monthlyRate = annualRate / 100 / 12;
        if (monthlyRate === 0) return principal / months;
        return principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / 
               (Math.pow(1 + monthlyRate, months) - 1);
    }
    
    // ×—×™×©×•×‘ ×¡×›×•× ×”×œ×•×•××” ××§×¡×™××œ×™
    function calcMaxLoan(maxPayment, annualRate, months) {
        const monthlyRate = annualRate / 100 / 12;
        if (monthlyRate === 0) return maxPayment * months;
        return maxPayment * (Math.pow(1 + monthlyRate, months) - 1) / 
               (monthlyRate * Math.pow(1 + monthlyRate, months));
    }
    
    // ×¢×“×›×•×Ÿ ××“ ×‘×˜×™×—×•×ª
    function updateGauge(dti, needleId, valueId, badgeId) {
        const needle = getElement(needleId);
        const value = getElement(valueId);
        const badge = getElement(badgeId);
        
        if (!needle || !value || !badge) {
            console.error('Gauge elements not found:', needleId, valueId, badgeId);
            return;
        }
        
        // ×”××¨×ª DTI ×œ×–×•×•×™×ª (0% = -90deg, 50%+ = 90deg)
        let angle = (dti / 50) * 180 - 90;
        angle = Math.max(-90, Math.min(90, angle));
        
        // ×¢×“×›×•×Ÿ transform ×œ×œ× important ×‘CSS
        needle.style.transform = `translateX(-50%) rotate(${angle}deg)`;
        value.textContent = formatPercent(dti);
        
        // ×§×‘×™×¢×ª ×¡×˜×˜×•×¡
        value.className = 'wpc-calc-dti-k4m7-gauge-value';
        badge.className = 'wpc-calc-dti-k4m7-status-badge';
        
        if (dti < 30) {
            value.classList.add('safe');
            badge.classList.add('safe');
            badge.textContent = 'âœ… ××–×•×¨ ×‘×˜×•×— - ×¡×™×›×•×™×™ ××™×©×•×¨ ×’×‘×•×”×™×';
        } else if (dti <= 40) {
            value.classList.add('warning');
            badge.classList.add('warning');
            badge.textContent = 'âš ï¸ ××–×•×¨ ×–×”×™×¨×•×ª - ×™×™×ª×›× ×• ×”×’×‘×œ×•×ª';
        } else {
            value.classList.add('danger');
            badge.classList.add('danger');
            badge.textContent = 'âŒ ××–×•×¨ ×¡×™×›×•×Ÿ - ×¡×™×›×•×™×™ ××™×©×•×¨ × ××•×›×™×';
        }
    }
    
    // ×—×™×©×•×‘ ×œ×©×•× ×™×ª ×‘×¡×™×¡×™×ª
    function calcBasic() {
        const income = parseInt(getElement('basic-income-slider').value);
        const existing = parseInt(getElement('basic-existing-slider').value);
        const newLoan = parseInt(getElement('basic-new-slider').value);
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¢×¨×›×™×
        getElement('basic-income-value').textContent = formatCurrency(income);
        getElement('basic-existing-value').textContent = formatCurrency(existing);
        getElement('basic-new-value').textContent = formatCurrency(newLoan);
        
        // ×—×™×©×•×‘×™×
        const totalPayments = existing + newLoan;
        const dti = (totalPayments / income) * 100;
        const remaining = income - totalPayments;
        const maxPayment40 = income * 0.4;
        const maxPayment30 = income * 0.3;
        
        // ×¢×“×›×•×Ÿ ×ª×•×¦××•×ª
        getElement('basic-total-payments').textContent = formatCurrency(totalPayments);
        getElement('basic-dti-percent').textContent = formatPercent(dti);
        getElement('basic-remaining').textContent = formatCurrency(remaining);
        
        // ×¢×“×›×•×Ÿ ××“
        updateGauge(dti, 'basic-gauge-needle', 'basic-dti-value', 'basic-status-badge');
        
        // ×¢×“×›×•×Ÿ ×”××œ×¦×”
        getElement('rec-dti').textContent = formatPercent(dti);
        getElement('rec-max-payment').textContent = formatCurrency(maxPayment40 - existing);
    }
    
    // ×—×™×©×•×‘ ×œ×©×•× ×™×ª ×”×œ×•×•××” ××§×¡×™××œ×™×ª
    function calcMaxLoanTab() {
        const income = parseInt(getElement('max-income-slider').value);
        const existing = parseInt(getElement('max-existing-slider').value);
        const years = parseInt(getElement('max-years-slider').value);
        const rate = parseFloat(getElement('max-rate-slider').value);
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¢×¨×›×™×
        getElement('max-income-value').textContent = formatCurrency(income);
        getElement('max-existing-value').textContent = formatCurrency(existing);
        getElement('max-years-value').textContent = years + ' ×©× ×™×';
        getElement('max-rate-value').textContent = rate + '%';
        
        const months = years * 12;
        
        // ×—×™×©×•×‘ ×”×—×–×¨ ××§×¡×™××œ×™ ××¤×©×¨×™
        const maxPayment30 = (income * 0.3) - existing;
        const maxPayment40 = (income * 0.4) - existing;
        
        // ×—×™×©×•×‘ ×¡×›×•× ×”×œ×•×•××” ××§×¡×™××œ×™
        const maxLoan30 = maxPayment30 > 0 ? calcMaxLoan(maxPayment30, rate, months) : 0;
        const maxLoan40 = maxPayment40 > 0 ? calcMaxLoan(maxPayment40, rate, months) : 0;
        
        // ×¢×“×›×•×Ÿ ×ª×•×¦××•×ª
        getElement('max-loan-30').textContent = formatCurrency(Math.max(0, maxLoan30));
        getElement('max-loan-40').textContent = formatCurrency(Math.max(0, maxLoan40));
        getElement('max-payment-allowed').textContent = formatCurrency(Math.max(0, maxPayment40));
    }
    
    // ×—×™×©×•×‘ ×¡×™××•×œ×˜×•×¨
    function calcSimulator() {
        const income = parseInt(getElement('sim-income-slider').value);
        const existing = parseInt(getElement('sim-existing-slider').value);
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¢×¨×›×™×
        getElement('sim-income-value').textContent = formatCurrency(income);
        getElement('sim-existing-value').textContent = formatCurrency(existing);
        
        // ×ª×¨×—×™×© 1: ×”×¢×œ××ª ××©×›×•×¨×ª ×‘-20%
        const newIncome1 = income * 1.2;
        const dti1 = (existing / newIncome1) * 100;
        getElement('sim-scenario1-income').textContent = formatCurrency(newIncome1);
        getElement('sim-scenario1-dti').textContent = formatPercent(dti1);
        getElement('sim-scenario1-dti').style.color = dti1 < 30 ? 'var(--wpc-dti-success)' : dti1 <= 40 ? 'var(--wpc-dti-warning)' : 'var(--wpc-dti-danger)';
        
        // ×ª×¨×—×™×© 2: ×¡×’×™×¨×ª ×”×œ×•×•××” ×©×œ 2000
        const newExisting2 = Math.max(0, existing - 2000);
        const dti2 = (newExisting2 / income) * 100;
        getElement('sim-scenario2-payments').textContent = formatCurrency(newExisting2);
        getElement('sim-scenario2-dti').textContent = formatPercent(dti2);
        getElement('sim-scenario2-dti').style.color = dti2 < 30 ? 'var(--wpc-dti-success)' : dti2 <= 40 ? 'var(--wpc-dti-warning)' : 'var(--wpc-dti-danger)';
        
        // ×ª×¨×—×™×© 3: ×œ×§×™×—×ª ××©×›× ×ª× 4000
        const newExisting3 = existing + 4000;
        const dti3 = (newExisting3 / income) * 100;
        getElement('sim-scenario3-payments').textContent = formatCurrency(newExisting3);
        getElement('sim-scenario3-dti').textContent = formatPercent(dti3);
        getElement('sim-scenario3-dti').style.color = dti3 < 30 ? 'var(--wpc-dti-success)' : dti3 <= 40 ? 'var(--wpc-dti-warning)' : 'var(--wpc-dti-danger)';
    }
    
    // ××¢×‘×¨ ×‘×™×Ÿ ×œ×©×•× ×™×•×ª
    function switchTab(tabName) {
        const tabs = container.querySelectorAll('.wpc-calc-dti-k4m7-tab-btn');
        const contents = container.querySelectorAll('.wpc-calc-dti-k4m7-tab-content');
        
        tabs.forEach(tab => tab.classList.remove('active'));
        contents.forEach(content => content.classList.remove('active'));
        
        const activeTab = container.querySelector(`[data-tab="${tabName}"]`);
        const activeContent = getElement(`tab-${tabName}`);
        
        if (activeTab) activeTab.classList.add('active');
        if (activeContent) activeContent.classList.add('active');
        
        // ×—×™×©×•×‘ ××—×“×© ×‘×”×ª×× ×œ×œ×©×•× ×™×ª
        if (tabName === 'basic') calcBasic();
        else if (tabName === 'max-loan') calcMaxLoanTab();
        else if (tabName === 'simulator') calcSimulator();
    }
    
    // ×¤×ª×™×—×ª ×˜×•×¤×¡ ×–×›××•×ª
    function openAWG() {
        const content = getElement('awg-content');
        content.classList.toggle('active');
    }
    
    // ×’×œ×™×œ×” ×œ×”×˜××¢×”
    function scrollToEmbed() {
        const embedSection = getElement('embed-section');
        if (embedSection) {
            embedSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
    
    // ×”×—×œ×¤×ª ××¦×‘ ×©××œ×” × ×¤×•×¦×”
    function toggleFaq(button) {
        const item = button.closest('.wpc-calc-dti-k4m7-faq-item');
        item.classList.toggle('active');
    }
    
    // ×¦×‘×¢ × ×•×›×—×™ ×œ×ª×¦×•×’×” ××§×“×™××”
    let currentPreviewColor = '#1e5490';
    let currentColorName = '×›×—×•×œ ××§×¦×•×¢×™';
    
    // ×¤×•× ×§×¦×™×™×ª ×™×¦×™×¨×ª ×¡×§×¨×™×¤×˜ ×œ×”×˜××¢×” - ×’×¨×¡×” ××œ××” ×¢× ×›×œ ×”×˜××‘×™×!
    function getEmbedScript() {
        var s = '<scr' + 'ipt>';
        s += 'document.addEventListener("DOMContentLoaded",function(){';
        s += '(function(){"use strict";';
        s += 'var NS="WPC_CalcDTI_Embed_"+Date.now();if(window[NS])return;';
        s += 'var c=document.querySelector("[class*=\'wpc-calc-dti\']");if(!c)return;';
        s += 'function el(id){return document.getElementById(id)}';
        s += 'function fmt(n){return Math.round(n).toLocaleString("he-IL")+" â‚ª"}';
        s += 'function fmtPct(n){return n.toFixed(1)+"%"}';
        s += 'function calcMaxLoan(p,r,m){var x=r/100/12;if(x===0)return p*m;return p*(Math.pow(1+x,m)-1)/(x*Math.pow(1+x,m))}';
        s += 'function switchTab(t){var tabs=c.querySelectorAll("[data-action=\'switch-tab\']");var contents=c.querySelectorAll("[class*=\'tab-content\']");';
        s += 'for(var i=0;i<tabs.length;i++)tabs[i].classList.remove("active");';
        s += 'for(var j=0;j<contents.length;j++){contents[j].classList.remove("active");contents[j].style.display="none"}';
        s += 'var at=c.querySelector("[data-tab=\'"+t+"\']");if(at)at.classList.add("active");';
        s += 'var ac=el("tab-"+t);if(ac){ac.classList.add("active");ac.style.display="block"}';
        s += 'if(t==="basic")calcBasic();else if(t==="max-loan")calcMaxLoanTab();else if(t==="simulator")calcSimulator()}';
        s += 'function updateGauge(d){var n=el("basic-gauge-needle"),v=el("basic-dti-value"),b=el("basic-status-badge");if(!n||!v||!b)return;';
        s += 'var a=(d/50)*180-90;a=Math.max(-90,Math.min(90,a));n.style.transform="translateX(-50%) rotate("+a+"deg)";v.textContent=fmtPct(d);';
        s += 'v.className="wpc-calc-dti-k4m7-gauge-value";b.className="wpc-calc-dti-k4m7-status-badge";';
        s += 'if(d<30){v.classList.add("safe");b.classList.add("safe");b.textContent="âœ… ××–×•×¨ ×‘×˜×•×—"}';
        s += 'else if(d<=40){v.classList.add("warning");b.classList.add("warning");b.textContent="âš ï¸ ××–×•×¨ ×–×”×™×¨×•×ª"}';
        s += 'else{v.classList.add("danger");b.classList.add("danger");b.textContent="âŒ ××–×•×¨ ×¡×™×›×•×Ÿ"}}';
        s += 'function calcBasic(){var i=parseInt(el("basic-income-slider")?.value||20000),e=parseInt(el("basic-existing-slider")?.value||3000),n=parseInt(el("basic-new-slider")?.value||2000);';
        s += 'if(el("basic-income-value"))el("basic-income-value").textContent=fmt(i);if(el("basic-existing-value"))el("basic-existing-value").textContent=fmt(e);if(el("basic-new-value"))el("basic-new-value").textContent=fmt(n);';
        s += 'var t=e+n,d=(t/i)*100,r=i-t;if(el("basic-total-payments"))el("basic-total-payments").textContent=fmt(t);if(el("basic-dti-percent"))el("basic-dti-percent").textContent=fmtPct(d);if(el("basic-remaining"))el("basic-remaining").textContent=fmt(r);';
        s += 'updateGauge(d);if(el("rec-dti"))el("rec-dti").textContent=fmtPct(d);if(el("rec-max-payment"))el("rec-max-payment").textContent=fmt(Math.max(0,i*0.4-e))}';
        s += 'function calcMaxLoanTab(){var i=parseInt(el("max-income-slider")?.value||20000),e=parseInt(el("max-existing-slider")?.value||3000),y=parseInt(el("max-years-slider")?.value||5),r=parseFloat(el("max-rate-slider")?.value||6);';
        s += 'if(el("max-income-value"))el("max-income-value").textContent=fmt(i);if(el("max-existing-value"))el("max-existing-value").textContent=fmt(e);if(el("max-years-value"))el("max-years-value").textContent=y+" ×©× ×™×";if(el("max-rate-value"))el("max-rate-value").textContent=r+"%";';
        s += 'var m=y*12,p30=(i*0.3)-e,p40=(i*0.4)-e,l30=p30>0?calcMaxLoan(p30,r,m):0,l40=p40>0?calcMaxLoan(p40,r,m):0;';
        s += 'if(el("max-loan-30"))el("max-loan-30").textContent=fmt(Math.max(0,l30));if(el("max-loan-40"))el("max-loan-40").textContent=fmt(Math.max(0,l40));if(el("max-payment-allowed"))el("max-payment-allowed").textContent=fmt(Math.max(0,p40))}';
        s += 'function calcSimulator(){var i=parseInt(el("sim-income-slider")?.value||20000),e=parseInt(el("sim-existing-slider")?.value||5000);';
        s += 'if(el("sim-income-value"))el("sim-income-value").textContent=fmt(i);if(el("sim-existing-value"))el("sim-existing-value").textContent=fmt(e);';
        s += 'var n1=i*1.2,d1=(e/n1)*100;if(el("sim-scenario1-income"))el("sim-scenario1-income").textContent=fmt(n1);if(el("sim-scenario1-dti")){el("sim-scenario1-dti").textContent=fmtPct(d1);el("sim-scenario1-dti").style.color=d1<30?"#25D366":d1<=40?"#f39c12":"#e74c3c"}';
        s += 'var e2=Math.max(0,e-2000),d2=(e2/i)*100;if(el("sim-scenario2-payments"))el("sim-scenario2-payments").textContent=fmt(e2);if(el("sim-scenario2-dti")){el("sim-scenario2-dti").textContent=fmtPct(d2);el("sim-scenario2-dti").style.color=d2<30?"#25D366":d2<=40?"#f39c12":"#e74c3c"}';
        s += 'var e3=e+4000,d3=(e3/i)*100;if(el("sim-scenario3-payments"))el("sim-scenario3-payments").textContent=fmt(e3);if(el("sim-scenario3-dti")){el("sim-scenario3-dti").textContent=fmtPct(d3);el("sim-scenario3-dti").style.color=d3<30?"#25D366":d3<=40?"#f39c12":"#e74c3c"}}';
        s += 'c.addEventListener("click",function(e){var a=e.target.closest("[data-action]");if(!a)return;var t=a.dataset.action;if(t==="switch-tab")switchTab(a.dataset.tab);if(t==="toggle-faq"){var it=a.closest("[class*=\'faq-item\']");if(it)it.classList.toggle("active")}});';
        s += 'c.addEventListener("input",function(e){if(e.target.type!=="range")return;var id=e.target.id;if(id.indexOf("basic-")===0)calcBasic();else if(id.indexOf("max-")===0)calcMaxLoanTab();else if(id.indexOf("sim-")===0)calcSimulator()});';
        s += 'calcBasic();calcMaxLoanTab();calcSimulator();window[NS]={v:"1.0"}})()});';
        s += '</scr' + 'ipt>';
        return s;
    }
    
    // ×”×¢×ª×§×ª ×§×•×“ ×”×˜××¢×”
    function copyEmbedCode(color) {
        color = color || '#1e5490';
        
        // ×§×‘×œ ××ª ×”-CSS ××ª×’×™×ª ×”-style ×”×¨××©×™×ª
        let styles = '';
        const styleElements = document.querySelectorAll('style');
        for (let i = 0; i < styleElements.length; i++) {
            const styleContent = styleElements[i].textContent;
            if (styleContent.includes('wpc-calc-dti-k4m7-wrapper')) {
                styles = styleContent;
                break;
            }
        }
        
        if (!styles) {
            console.error('CSS not found!');
            alert('×©×’×™××”: ×œ× × ××¦× CSS. × ×¡×” ×©×•×‘.');
            return;
        }
        
        // ×”×—×œ×£ ×¦×‘×¢ ×¨××©×™
        styles = styles.replace(/#1e5490/g, color);
        styles = styles.replace(/--wpc-dti-primary:\s*#1e5490/g, '--wpc-dti-primary: ' + color);
        
        // ×§×‘×œ ××ª ×”-HTML ×©×œ ×”××—×©×‘×•×Ÿ ×‘×œ×‘×“ (×œ×œ× embed section)
        const calculator = document.getElementById('wpc-calc-dti-k4m7-calculator');
        const titleSection = container.querySelector('.wpc-calc-dti-k4m7-title-container');
        
        if (!calculator) {
            console.error('Calculator not found!');
            alert('×©×’×™××”: ×œ× × ××¦× ××—×©×‘×•×Ÿ.');
            return;
        }
        
        // ×‘× ×™×™×ª ×”×§×•×“ - ×œ×œ× ×”×›×•×ª×¨×ª ×”×¨××©×™×ª (×›×™ ××›×™×œ×” shortcode ×©×œ ×•×•×¨×“×¤×¨×¡)
        var code = '<style>' + styles + '</style>';
        code += '<div class="wpc-calc-dti-k4m7-wrapper" id="wpc-calc-dti-k4m7-main">';
        code += calculator.outerHTML;
        code += '</div>';
        
        // ×”×•×¡×£ ×§×¨×“×™×˜
        code += '<p style="text-align:center; font-size:0.9em; margin-top:20px; color:#666;">';
        code += '××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” ×¤×•×ª×— ×¢×œ ×™×“×™ ';
        code += '<a href="https://loan-israel.co.il/" target="_blank" rel="nofollow noopener" ';
        code += 'style="color:' + color + '; text-decoration:underline;">×¨×§ ×ª×‘×§×© ×¤×™× × ×¡×™×</a>';
        code += '</p>';
        
        // ×”×•×¡×£ JavaScript
        code += getEmbedScript();
        
        // ×”×¢×ª×§ ×œ×œ×•×—
        navigator.clipboard.writeText(code).then(function() {
            const cssLen = styles.length;
            const jsLen = getEmbedScript().length;
            alert('âœ… ×”×§×•×“ ×”×•×¢×ª×§ ×‘×”×¦×œ×—×”!\n\n×›×•×œ×œ:\nâ€¢ CSS: ' + Math.round(cssLen/1024) + 'KB\nâ€¢ HTML ×©×œ ×”××—×©×‘×•×Ÿ\nâ€¢ JavaScript ××œ×\nâ€¢ ×§×¨×“×™×˜\n\n×”×“×‘×™×§×• ×‘×¢×•×¨×š ×•×•×¨×“×¤×¨×¡.');
        }).catch(function(err) {
            console.error('×©×’×™××” ×‘×”×¢×ª×§×”:', err);
            // Fallback
            const textarea = document.createElement('textarea');
            textarea.value = code;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                alert('âœ… ×”×§×•×“ ×”×•×¢×ª×§!');
            } catch(e) {
                alert('×©×’×™××” ×‘×”×¢×ª×§×”. × ×¡×” ×©×•×‘.');
            }
            document.body.removeChild(textarea);
        });
    }
    
    // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ×¦×‘×¢×™×
    function darkenColor(hex, percent) {
        const num = parseInt(hex.replace('#', ''), 16);
        const amt = Math.round(2.55 * percent);
        const R = Math.max((num >> 16) - amt, 0);
        const G = Math.max((num >> 8 & 0x00FF) - amt, 0);
        const B = Math.max((num & 0x0000FF) - amt, 0);
        return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
    }
    
    function hexToRgba(hex, alpha) {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        return 'rgba(' + r + ', ' + g + ', ' + b + ', ' + alpha + ')';
    }
    
    // ××ª×—×•×œ ××—×©×‘×•×Ÿ ×‘×ª×¦×•×’×” ××§×“×™××”
    function initPreviewCalculator(calc, primaryColor) {
        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ××§×•××™×•×ª
        function fmtCurrency(n) { return Math.round(n).toLocaleString('he-IL') + ' â‚ª'; }
        function fmtPercent(n) { return n.toFixed(1) + '%'; }
        function getEl(id) { return calc.querySelector('#' + id); }
        
        // ×¢×“×›×•×Ÿ ××“
        function updatePreviewGauge(dti) {
            const needle = getEl('preview-basic-gauge-needle');
            const value = getEl('preview-basic-dti-value');
            const badge = getEl('preview-basic-status-badge');
            if (!needle || !value || !badge) return;
            
            let angle = (dti / 50) * 180 - 90;
            angle = Math.max(-90, Math.min(90, angle));
            needle.style.transform = 'translateX(-50%) rotate(' + angle + 'deg)';
            value.textContent = fmtPercent(dti);
            
            value.className = 'wpc-calc-dti-k4m7-gauge-value';
            badge.className = 'wpc-calc-dti-k4m7-status-badge';
            
            if (dti < 30) {
                value.classList.add('safe'); badge.classList.add('safe');
                badge.textContent = 'âœ… ××–×•×¨ ×‘×˜×•×—';
            } else if (dti <= 40) {
                value.classList.add('warning'); badge.classList.add('warning');
                badge.textContent = 'âš ï¸ ××–×•×¨ ×–×”×™×¨×•×ª';
            } else {
                value.classList.add('danger'); badge.classList.add('danger');
                badge.textContent = 'âŒ ××–×•×¨ ×¡×™×›×•×Ÿ';
            }
        }
        
        // ×—×™×©×•×‘ ×”×œ×•×•××” ××§×¡×™××œ×™×ª
        function calcMaxLoanFormula(maxPay, rate, months) {
            const r = rate / 100 / 12;
            if (r === 0) return maxPay * months;
            return maxPay * (Math.pow(1 + r, months) - 1) / (r * Math.pow(1 + r, months));
        }
        
        // === ×˜××‘ 1: ×—×™×©×•×‘ ×‘×¡×™×¡×™ ===
        function calcPreviewBasic() {
            const incomeSlider = getEl('preview-basic-income-slider');
            const existingSlider = getEl('preview-basic-existing-slider');
            const newSlider = getEl('preview-basic-new-slider');
            if (!incomeSlider) return;
            
            const income = parseInt(incomeSlider.value);
            const existing = parseInt(existingSlider?.value || 3000);
            const newLoan = parseInt(newSlider?.value || 2000);
            
            const incomeVal = getEl('preview-basic-income-value');
            const existingVal = getEl('preview-basic-existing-value');
            const newVal = getEl('preview-basic-new-value');
            
            if (incomeVal) incomeVal.textContent = fmtCurrency(income);
            if (existingVal) existingVal.textContent = fmtCurrency(existing);
            if (newVal) newVal.textContent = fmtCurrency(newLoan);
            
            const totalPayments = existing + newLoan;
            const dti = (totalPayments / income) * 100;
            const remaining = income - totalPayments;
            
            const totalEl = getEl('preview-basic-total-payments');
            const dtiEl = getEl('preview-basic-dti-percent');
            const remainingEl = getEl('preview-basic-remaining');
            
            if (totalEl) totalEl.textContent = fmtCurrency(totalPayments);
            if (dtiEl) dtiEl.textContent = fmtPercent(dti);
            if (remainingEl) remainingEl.textContent = fmtCurrency(remaining);
            
            updatePreviewGauge(dti);
            
            // ×”××œ×¦×”
            const recDti = getEl('preview-rec-dti');
            const recMax = getEl('preview-rec-max-payment');
            if (recDti) recDti.textContent = fmtPercent(dti);
            if (recMax) recMax.textContent = fmtCurrency(Math.max(0, income * 0.4 - existing));
        }
        
        // === ×˜××‘ 2: ×”×œ×•×•××” ××§×¡×™××œ×™×ª ===
        function calcPreviewMaxLoan() {
            const incomeSlider = getEl('preview-max-income-slider');
            const existingSlider = getEl('preview-max-existing-slider');
            const yearsSlider = getEl('preview-max-years-slider');
            const rateSlider = getEl('preview-max-rate-slider');
            if (!incomeSlider) return;
            
            const income = parseInt(incomeSlider.value);
            const existing = parseInt(existingSlider?.value || 3000);
            const years = parseInt(yearsSlider?.value || 5);
            const rate = parseFloat(rateSlider?.value || 6);
            
            // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¢×¨×›×™×
            const incomeVal = getEl('preview-max-income-value');
            const existingVal = getEl('preview-max-existing-value');
            const yearsVal = getEl('preview-max-years-value');
            const rateVal = getEl('preview-max-rate-value');
            
            if (incomeVal) incomeVal.textContent = fmtCurrency(income);
            if (existingVal) existingVal.textContent = fmtCurrency(existing);
            if (yearsVal) yearsVal.textContent = years + ' ×©× ×™×';
            if (rateVal) rateVal.textContent = rate + '%';
            
            // ×—×™×©×•×‘×™×
            const months = years * 12;
            const maxPay30 = (income * 0.3) - existing;
            const maxPay40 = (income * 0.4) - existing;
            const maxLoan30 = maxPay30 > 0 ? calcMaxLoanFormula(maxPay30, rate, months) : 0;
            const maxLoan40 = maxPay40 > 0 ? calcMaxLoanFormula(maxPay40, rate, months) : 0;
            
            // ×¢×“×›×•×Ÿ ×ª×•×¦××•×ª
            const loan30El = getEl('preview-max-loan-30');
            const loan40El = getEl('preview-max-loan-40');
            const paymentEl = getEl('preview-max-payment-allowed');
            
            if (loan30El) loan30El.textContent = fmtCurrency(Math.max(0, maxLoan30));
            if (loan40El) loan40El.textContent = fmtCurrency(Math.max(0, maxLoan40));
            if (paymentEl) paymentEl.textContent = fmtCurrency(Math.max(0, maxPay40));
        }
        
        // === ×˜××‘ 3: ×¡×™××•×œ×˜×•×¨ ===
        function calcPreviewSimulator() {
            const incomeSlider = getEl('preview-sim-income-slider');
            const existingSlider = getEl('preview-sim-existing-slider');
            if (!incomeSlider) return;
            
            const income = parseInt(incomeSlider.value);
            const existing = parseInt(existingSlider?.value || 5000);
            
            // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¢×¨×›×™×
            const incomeVal = getEl('preview-sim-income-value');
            const existingVal = getEl('preview-sim-existing-value');
            if (incomeVal) incomeVal.textContent = fmtCurrency(income);
            if (existingVal) existingVal.textContent = fmtCurrency(existing);
            
            // ×ª×¨×—×™×© 1: ×”×¢×œ××ª ××©×›×•×¨×ª ×‘-20%
            const newIncome1 = income * 1.2;
            const dti1 = (existing / newIncome1) * 100;
            const s1Income = getEl('preview-sim-scenario1-income');
            const s1Dti = getEl('preview-sim-scenario1-dti');
            if (s1Income) s1Income.textContent = fmtCurrency(newIncome1);
            if (s1Dti) {
                s1Dti.textContent = fmtPercent(dti1);
                s1Dti.style.color = dti1 < 30 ? '#25D366' : dti1 <= 40 ? '#f39c12' : '#e74c3c';
            }
            
            // ×ª×¨×—×™×© 2: ×¡×’×™×¨×ª ×”×œ×•×•××” ×©×œ 2000
            const newExisting2 = Math.max(0, existing - 2000);
            const dti2 = (newExisting2 / income) * 100;
            const s2Payments = getEl('preview-sim-scenario2-payments');
            const s2Dti = getEl('preview-sim-scenario2-dti');
            if (s2Payments) s2Payments.textContent = fmtCurrency(newExisting2);
            if (s2Dti) {
                s2Dti.textContent = fmtPercent(dti2);
                s2Dti.style.color = dti2 < 30 ? '#25D366' : dti2 <= 40 ? '#f39c12' : '#e74c3c';
            }
            
            // ×ª×¨×—×™×© 3: ×œ×§×™×—×ª ××©×›× ×ª× 4000
            const newExisting3 = existing + 4000;
            const dti3 = (newExisting3 / income) * 100;
            const s3Payments = getEl('preview-sim-scenario3-payments');
            const s3Dti = getEl('preview-sim-scenario3-dti');
            if (s3Payments) s3Payments.textContent = fmtCurrency(newExisting3);
            if (s3Dti) {
                s3Dti.textContent = fmtPercent(dti3);
                s3Dti.style.color = dti3 < 30 ? '#25D366' : dti3 <= 40 ? '#f39c12' : '#e74c3c';
            }
        }
        
        // ×˜××‘×™× ×¢× stopPropagation
        calc.querySelectorAll('[data-action="switch-tab"]').forEach(function(tab) {
            tab.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const tabName = this.dataset.tab;
                
                calc.querySelectorAll('[data-action="switch-tab"]').forEach(function(t) {
                    t.classList.remove('active');
                    t.style.setProperty('background', 'transparent', 'important');
                    t.style.setProperty('color', '#555', 'important');
                });
                
                calc.querySelectorAll('[data-preview-tab]').forEach(function(c) {
                    c.classList.remove('active');
                    c.style.display = 'none';
                });
                
                this.classList.add('active');
                this.style.setProperty('background', '#fff', 'important');
                this.style.setProperty('color', primaryColor, 'important');
                this.style.setProperty('border-bottom-color', primaryColor, 'important');
                
                const activeContent = calc.querySelector('[data-preview-tab="' + tabName + '"]');
                if (activeContent) {
                    activeContent.classList.add('active');
                    activeContent.style.display = 'block';
                }
                
                // ×—×™×©×•×‘ ××—×“×© ×œ×¤×™ ×”×˜××‘
                if (tabName === 'basic') calcPreviewBasic();
                else if (tabName === 'max-loan') calcPreviewMaxLoan();
                else if (tabName === 'simulator') calcPreviewSimulator();
            });
        });
        
        // ×¡×œ×™×™×“×¨×™× ×¢× stopPropagation - ×§×¨×™××” ×œ×¤×•× ×§×¦×™×” ×”× ×›×•× ×” ×œ×¤×™ ×”×˜××‘
        calc.querySelectorAll('input[type="range"]').forEach(function(slider) {
            slider.addEventListener('input', function(e) {
                e.stopPropagation();
                const id = this.id;
                if (id.includes('basic-')) {
                    calcPreviewBasic();
                } else if (id.includes('max-')) {
                    calcPreviewMaxLoan();
                } else if (id.includes('sim-')) {
                    calcPreviewSimulator();
                }
            });
            slider.style.setProperty('accent-color', primaryColor, 'important');
        });
        
        // FAQ
        calc.querySelectorAll('[data-action="toggle-faq"]').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const item = this.closest('[class*="faq-item"]');
                if (item) item.classList.toggle('active');
            });
        });
        
        // ××ª×—×•×œ ×¨××©×•× ×™ - ×›×œ ×”×˜××‘×™×
        calcPreviewBasic();
        calcPreviewMaxLoan();
        calcPreviewSimulator();
    }
    
    // ×”×¦×’×ª ×ª×¦×•×’×” ××§×“×™××” - ×’×¨×¡×” ××ª×•×§× ×ª!
    function showPreview(color, colorName) {
        currentPreviewColor = color;
        currentColorName = colorName;
        
        const previewArea = getElement('preview-area');
        const previewContainer = getElement('preview-container');
        const colorNameSpan = getElement('preview-color-name');
        
        if (colorNameSpan) colorNameSpan.textContent = colorName;
        
        const calculator = document.getElementById('wpc-calc-dti-k4m7-calculator');
        if (!calculator || !previewContainer) return;
        
        // ×©×›×¤×œ ××ª ×”××—×©×‘×•×Ÿ
        const calc = calculator.cloneNode(true);
        
        // ×©× ×” ID ×œ×× ×™×¢×ª ×”×ª× ×’×©×•×ª
        calc.id = 'wpc-calc-dti-k4m7-calculator-preview';
        
        // ×”×—×œ×£ IDs ×©×œ ×ª×›× ×™× ×‘-data attributes
        calc.querySelectorAll('[id^="tab-"]').forEach(function(tabContent) {
            const oldId = tabContent.id;
            const tabName = oldId.replace('tab-', '');
            tabContent.setAttribute('data-preview-tab', tabName);
            tabContent.id = 'preview-' + oldId;
        });
        
        // ×”×—×œ×£ IDs ×©×œ ××œ×× ×˜×™× ××—×¨×™×
        calc.querySelectorAll('[id]').forEach(function(el) {
            if (!el.id.startsWith('preview-')) {
                el.id = 'preview-' + el.id;
            }
        });
        
        // ×”×’×“×¨ CSS Variables ×¢×œ ×”××œ×× ×˜ ×”××©×•×›×¤×œ
        calc.style.setProperty('--wpc-dti-primary', color);
        calc.style.setProperty('--wpc-dti-primary-dark', darkenColor(color, 15));
        calc.style.setProperty('--wpc-dti-primary-light', hexToRgba(color, 0.1));
        
        // ×”×—×œ×£ ×¦×‘×¢×™× ×¢× setProperty + important
        calc.querySelectorAll('[class*="title"], [class*="header"], h1, h2, h3, h4').forEach(function(el) {
            if (getComputedStyle(el).color.includes('30, 84, 144') || el.style.color) {
                el.style.setProperty('color', color, 'important');
            }
        });
        
        // ×˜××‘ ×¤×¢×™×œ
        const activeTab = calc.querySelector('[data-action="switch-tab"].active');
        if (activeTab) {
            activeTab.style.setProperty('border-bottom-color', color, 'important');
            activeTab.style.setProperty('color', color, 'important');
        }
        
        // ×¢×¨×›×™ ×¡×œ×™×™×“×¨
        calc.querySelectorAll('[class*="slider-value"]').forEach(function(el) {
            el.style.setProperty('color', color, 'important');
        });
        
        // ×¡×œ×™×™×“×¨×™×
        calc.querySelectorAll('input[type="range"]').forEach(function(slider) {
            slider.style.setProperty('accent-color', color, 'important');
        });
        
        // ×›×¤×ª×•×¨ active ×¨××©×•×Ÿ
        const firstTabContent = calc.querySelector('[data-preview-tab]');
        if (firstTabContent) {
            firstTabContent.classList.add('active');
            firstTabContent.style.display = 'block';
        }
        
        // ×”×¡×ª×¨ ×©××¨ ×”×˜××‘×™×
        calc.querySelectorAll('[data-preview-tab]').forEach(function(tab, i) {
            if (i > 0) {
                tab.classList.remove('active');
                tab.style.display = 'none';
            }
        });
        
        // ×”×¦×’
        previewContainer.innerHTML = '';
        previewContainer.appendChild(calc);
        
        // ××ª×—×œ ××ª ×”-JS ××—×“×©!
        initPreviewCalculator(calc, color);
        
        if (previewArea) {
            previewArea.style.display = 'block';
            previewArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
    
    // ×”×¢×ª×§×ª ×§×•×“ ××”×ª×¦×•×’×” ×”××§×“×™××”
    function copyPreviewCode() {
        // DataLayer Push - Tag Manager tracking
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
            'event': 'copy_code_click',
            'calculator_name': 'ğŸ¦ ××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (DTI) - ×”×× ×™××©×¨×• ×œ×™ ×”×œ×•×•××”?',
            'button_type': 'copy-preview-code'
        });
        
        copyEmbedCode(currentPreviewColor);
    }
    
    // ×˜×™×¤×•×œ ×‘-color picker ××•×ª×× ××™×©×™×ª
    const customColorPicker = getElement('custom-color-picker');
    if (customColorPicker) {
        customColorPicker.addEventListener('input', function(e) {
            showPreview(e.target.value, '×¦×‘×¢ ××•×ª×× ××™×©×™×ª');
        });
    }
    
    // ×˜×™×¤×•×œ ×‘××™×¨×•×¢×™×
    container.addEventListener('click', function(e) {
        const action = e.target.closest('[data-action]');
        if (!action) return;
        
        const actionType = action.dataset.action;
        
        switch(actionType) {
            case 'switch-tab':
                switchTab(action.dataset.tab);
                break;
            case 'open-awg':
                openAWG();
                break;
            case 'scroll-to-embed':
                scrollToEmbed();
                break;
            case 'toggle-faq':
                toggleFaq(action);
                break;
            case 'preview-color':
                showPreview(action.dataset.color, action.dataset.name);
                break;
            case 'copy-embed-code':
                copyEmbedCode();
                break;
            case 'copy-preview-code':
                copyPreviewCode();
                break;
        }
    });
    
    container.addEventListener('input', function(e) {
        const sliderId = e.target.id;
        
        if (sliderId.startsWith('basic-')) {
            calcBasic();
        } else if (sliderId.startsWith('max-')) {
            calcMaxLoanTab();
        } else if (sliderId.startsWith('sim-')) {
            calcSimulator();
        }
    });
    
    // ××ª×—×•×œ
    calcBasic();
    calcMaxLoanTab();
    calcSimulator();
    
    window[namespace] = { version: '1.0.0' };
})();
</script>

<!-- Schema.org ××™×“×¢ ××•×‘× ×” -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "××”×• ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (DTI) ×•×œ××” ×”×•× ×—×©×•×‘?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (Debt-to-Income) ×”×•× ××“×“ ×¤×™× × ×¡×™ ×©××—×©×‘ ××ª ××—×•×– ×”×”×›× ×¡×” ×”×—×•×“×©×™×ª ×©××•×§×“×© ×œ×”×—×–×¨×™ ×—×•×‘×•×ª. ×‘× ×§×™× ×•××•×¡×“×•×ª ×¤×™× × ×¡×™×™× ××©×ª××©×™× ×‘××“×“ ×–×” ×›×“×™ ×œ×”×¢×¨×™×š ××ª ×™×›×•×œ×ª ×”×”×—×–×¨ ×©×œ ×”×œ×•×•×”."
      }
    },
    {
      "@type": "Question",
      "name": "××”×• ×™×—×¡ ×”×”×—×–×¨ ×”××§×¡×™××œ×™ ×©×‘× ×§ ×™×©×¨××œ ×××¤×©×¨?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "×‘× ×§ ×™×©×¨××œ ××’×‘×™×œ ××ª ×™×—×¡ ×”×”×—×–×¨ ×”××§×¡×™××œ×™ ×œ-40% ××”×”×›× ×¡×” ×”×¤× ×•×™×”. ×‘××©×›× ×ª××•×ª ××•××œ×¥ ×œ× ×œ×¢×‘×•×¨ 33%."
      }
    },
    {
      "@type": "Question",
      "name": "××™×œ×• ×”×—×–×¨×™× × ×›×œ×œ×™× ×‘×—×™×©×•×‘ ×™×—×¡ ×”×”×—×–×¨?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "×‘×—×™×©×•×‘ × ×›×œ×œ×™×: ××©×›× ×ª×, ×”×œ×•×•××•×ª ×‘× ×§××™×•×ª, ×”×œ×•×•××•×ª ×œ×¨×›×‘, ×ª×©×œ×•××™× ×œ×›×¨×˜×™×¡×™ ××©×¨××™, ×”×œ×•×•××•×ª ××§×¨×Ÿ ×”×©×ª×œ××•×ª ××• ×¤× ×¡×™×”, ×•×”×œ×•×•××•×ª ×—×•×¥-×‘× ×§××™×•×ª."
      }
    }
  ]
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FinancialProduct",
  "name": "××—×©×‘×•×Ÿ ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” (DTI)",
  "description": "××—×©×‘×•×Ÿ ×œ×‘×“×™×§×ª ×™×—×¡ ×”×—×–×¨ ××”×›× ×¡×” - ×”×× ×™××©×¨×• ×œ×™ ×”×œ×•×•××”? ×‘×•×“×§ ×× ××ª×” ×¢×•××“ ×‘××’×‘×œ×•×ª ×‘× ×§ ×™×©×¨××œ.",
  "category": "××—×©×‘×•×Ÿ ×¤×™× × ×¡×™",
  "featureList": ["×‘×“×™×§×ª ×™×—×¡ ×”×—×–×¨", "×—×™×©×•×‘ ×”×œ×•×•××” ××§×¡×™××œ×™×ª", "×¡×™××•×œ×˜×•×¨ ×ª×¨×—×™×©×™×", "××“ ×‘×˜×™×—×•×ª ×•×™×–×•××œ×™"],
  "provider": {
    "@type": "Organization",
    "name": "×¨×§ ×ª×‘×§×© - ××¤×˜×¨×™×• ×‘×¢×´×",
    "url": "https://loan-israel.co.il"
  },
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "ILS"
  }
}
</script>

